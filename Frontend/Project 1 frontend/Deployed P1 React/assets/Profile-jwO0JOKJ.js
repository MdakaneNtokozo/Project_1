import{l as e,m as t,n,s as r,t as i}from"./index-Dy5shDWX.js";import{r as a,t as o}from"./Header-BUxtEV5o.js";var s=t(e()),c=t(n());function l(){let{api:e,token:t,setToken:n,user:l,setUser:u,currency:d,setCurrency:f}=(0,s.useContext)(i),[p,m]=(0,s.useState)(``),[h,g]=(0,s.useState)([]),_=(0,s.useRef)(),v=(0,s.useRef)(),y=(0,s.useRef)(),b=(0,s.useRef)(),x=(0,s.useRef)(),[S,C]=(0,s.useState)(l.userName),[w,T]=(0,s.useState)(l.userSurname),[E,D]=(0,s.useState)(l.userBio),[O,k]=(0,s.useState)(l.userEmail),[A,j]=(0,s.useState)(d.currencyId),M=r();(0,s.useEffect)(()=>{var n=e+`Destinations/getCurrencies`;fetch(n,{method:`GET`,headers:{Authorization:`Bearer `+t,"Content-Type":`application/json`}}).then(async e=>{let t=await e.json();g(t)})},[]);let N=()=>{var n=e+`LoginSignup/updateProfile`;fetch(n,{method:`PUT`,headers:{Authorization:`Bearer `+t,"Content-Type":`application/json`},body:JSON.stringify(l)}).then(async e=>{e.ok&&(u(await e.json()),m(``))})},P=()=>{l.userName!=S&&(l.userName=S),l.userSurname!=w&&(l.userSurname=w),l.userBio!=E&&(l.userBio=E),N(),alert(`Your profile details have been updated`),m(``)},F=()=>{var e=_.current.value,t=v.current.value;e==t&&(l.userEmail==e?alert(`Emails are the same`):(l.userEmail=e,N(),alert(`Your email is updated`),m(``)))},I=()=>{var e=y.current.value,t=b.current.value,n=x.current.value;t==n&&L(e,t)},L=(n,r)=>{var i=e+`LoginSignup/updatePassword?userId=`+l.userId+`&oldPassword=`+n+`&newPassword=`+r;fetch(i,{method:`PUT`,headers:{Authorization:`Bearer `+t,"Content-Type":`application/json`}}).then(async e=>{e.ok&&m(``)})},R=()=>{l.currencyId=A,N();var n=e+`Destinations/getCurrency?currencyId=`+l.currencyId;fetch(n,{method:`GET`,headers:{Authorization:`Bearer `+t,"Content-Type":`application/json`}}).then(async e=>{f(await e.json())}),alert(`New preffered currency has been set`)},z=()=>{n(``),u(null),M(`/`)};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o,{}),(0,c.jsxs)(`div`,{className:`container`,children:[(0,c.jsxs)(`div`,{className:`profile`,children:[(0,c.jsx)(`h2`,{children:`Profile`}),(0,c.jsxs)(`div`,{className:`profile-details`,children:[(0,c.jsx)(`img`,{src:`\\src\\assets\\profile.jpg`,alt:`profile picture`}),(0,c.jsxs)(`div`,{children:[(0,c.jsxs)(`p`,{children:[`Name: `,l.userName,` `]}),(0,c.jsxs)(`p`,{children:[`Surname: `,l.userSurname]}),(0,c.jsxs)(`p`,{children:[`Bio: `,l.userBio]})]})]}),(0,c.jsx)(`button`,{onClick:()=>m(`Profile`),children:`Edit profile`}),(0,c.jsxs)(`p`,{children:[`Email: `,l.userEmail]}),(0,c.jsx)(`button`,{onClick:()=>m(`Email`),children:`Edit email`}),(0,c.jsx)(`p`,{children:`Password: ******`}),(0,c.jsx)(`button`,{onClick:()=>m(`Password`),children:`Edit password`}),(0,c.jsx)(`p`,{children:`Currency preference:`}),(0,c.jsx)(`select`,{placeholder:`Select a currency preference`,value:A,onChange:e=>j(e.target.value),required:!0,children:h.map(e=>(0,c.jsxs)(`option`,{value:e.currencyId,children:[e.currencyName,` (`,e.currencySymbol,`)`]},e.currencyId))}),(0,c.jsx)(`button`,{onClick:()=>R(),children:`Set preference`}),(0,c.jsx)(`br`,{}),(0,c.jsx)(`br`,{}),(0,c.jsx)(`button`,{onClick:()=>z(),children:`Log out`})]}),p==`Profile`?(0,c.jsxs)(`div`,{className:`edit-profile`,children:[(0,c.jsx)(`h2`,{children:`Editing profile`}),(0,c.jsx)(`img`,{src:`\\src\\assets\\profile icon.png`,alt:`profile picture`}),(0,c.jsxs)(`div`,{children:[(0,c.jsx)(`p`,{children:`Name: `}),(0,c.jsx)(`input`,{placeholder:`name`,value:S,onChange:e=>C(e.target.value)}),(0,c.jsx)(`p`,{children:`Surname: `}),(0,c.jsx)(`input`,{placeholder:`surname`,value:w,onChange:e=>T(e.target.value)}),(0,c.jsx)(`p`,{children:`Bio: `}),(0,c.jsx)(`textarea`,{placeholder:`bio`,value:E,onChange:e=>D(e.target.value)})]}),(0,c.jsxs)(`div`,{children:[(0,c.jsx)(`button`,{onClick:()=>m(``),children:`Cancel`}),(0,c.jsx)(`button`,{onClick:()=>P(),children:`Save`})]})]}):(0,c.jsx)(c.Fragment,{}),p==`Email`?(0,c.jsxs)(`div`,{className:`edit-profile`,children:[(0,c.jsx)(`h2`,{children:`Editing email`}),(0,c.jsxs)(`div`,{children:[(0,c.jsx)(`p`,{children:`Previous email: `}),(0,c.jsx)(`input`,{placeholder:`previous email`,value:O,onChange:e=>k(e.target.value)}),(0,c.jsx)(`p`,{children:`New email: `}),(0,c.jsx)(`input`,{ref:_,placeholder:`new email`}),(0,c.jsx)(`p`,{children:`Retype email: `}),(0,c.jsx)(`input`,{ref:v,placeholder:`retype email`})]}),(0,c.jsxs)(`div`,{children:[(0,c.jsx)(`button`,{onClick:()=>m(``),children:`Cancel`}),(0,c.jsx)(`button`,{onClick:()=>F(),children:`Save`})]})]}):(0,c.jsx)(c.Fragment,{}),p==`Password`?(0,c.jsxs)(`div`,{className:`edit-profile`,children:[(0,c.jsx)(`h2`,{children:`Editing password`}),(0,c.jsxs)(`div`,{className:`edit-profile-form-info`,children:[(0,c.jsx)(`p`,{children:`Previous password: `}),(0,c.jsx)(`input`,{ref:y,placeholder:`previous password`}),(0,c.jsx)(`p`,{children:`New password: `}),(0,c.jsx)(`input`,{ref:b,placeholder:`new password`}),(0,c.jsx)(`p`,{children:`Confirm password: `}),(0,c.jsx)(`input`,{ref:x,placeholder:`confirm password`})]}),(0,c.jsxs)(`div`,{className:`edit-profile-form-buttons`,children:[(0,c.jsx)(`button`,{onClick:()=>m(``),children:`Cancel`}),(0,c.jsx)(`button`,{onClick:()=>I(),children:`Save`})]})]}):(0,c.jsx)(c.Fragment,{})]}),(0,c.jsx)(a,{})]})}var u=l;export{u as default};