import{l as e,m as t,n,s as r,t as i}from"./index-Dy5shDWX.js";import{t as a}from"./Loading-Dkvs0utl.js";import{r as o,t as s}from"./Header-BUxtEV5o.js";import{t as c}from"./dist-B3-LkRQH.js";var l=t(e()),u=t(c()),d=t(n());function f(){let[e,t]=(0,l.useState)([]),[n,c]=(0,l.useState)([]),[f,p]=(0,l.useState)([]),{user:m,api:h,token:g,setCurrency:_,setSelectedDestination:v}=(0,l.useContext)(i),y=r(),[b,x]=(0,l.useState)(!0),[S,C]=(0,l.useState)(!0);for((0,l.useEffect)(()=>{var e=h+`Destinations/getTopDestinations`;fetch(e,{method:`GET`,headers:{Authorization:`Bearer `+g,"Content-Type":`application/json`}}).then(async e=>{if(e.status==401)y(`/`);else if(p(await e.json()),e.ok){var t=h+`Destinations/getCountries`;fetch(t,{method:`GET`,headers:{Authorization:`Bearer `+g,"Content-Type":`application/json`}}).then(async e=>{c(await e.json()),x(!1)})}}),e=h+`Destinations/getCurrency?currencyId=`+m.currencyId,fetch(e,{method:`GET`,headers:{Authorization:`Bearer `+g,"Content-Type":`application/json`}}).then(async e=>{_(await e.json())}),e=h+`VacayPlansControllerr/getPlanInfo/`+m.userId,fetch(e,{method:`GET`,headers:{Authorization:`Bearer `+g,"Content-Type":`application/json`}}).then(async e=>{t(await e.json()),C(!1)})},[]);b==1||S==1;)return(0,d.jsx)(a,{});let w=e=>{y(`/viewVacayPlan`,{state:{plan:e}})},T=e=>{if(e==null)return``;var e=new Date(e);if(e!=``){let t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return t+`-`+n+`-`+(r<10?`0`+r:r)}};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s,{}),(0,d.jsx)(`div`,{className:`container`,children:(0,d.jsxs)(`div`,{className:`home`,children:[(0,d.jsxs)(`h2`,{children:[`Welcome `,m.userName]}),(0,d.jsx)(`hr`,{}),(0,d.jsx)(`h2`,{children:`Upcoming vacations`}),e.length==0?(0,d.jsx)(`div`,{className:`home-no-plans`,children:(0,d.jsx)(`h3`,{children:`No upcoming vacations planned`})}):(0,d.jsx)(`div`,{className:`home-plans`,children:e.map((t,n)=>{var r=new Date(T(Date.now()));if(new Date(T(e[0].vacation.vacationStartDate))>=r)return(0,d.jsxs)(`div`,{className:`plan`,onClick:()=>w(t),children:[(0,d.jsxs)(`p`,{className:`planLeft`,children:[`Vacation plan for `,t.destination.destinationName]}),(0,d.jsxs)(`p`,{className:`planRight`,children:[t.vacayDaysLeft,` days left`]})]},n)})}),(0,d.jsx)(`div`,{children:(0,d.jsx)(`button`,{onClick:()=>y(`/vacayPlan`),children:`Add vacation plan`})}),(0,d.jsx)(`hr`,{}),(0,d.jsx)(`h2`,{children:`Explore destination`}),(0,d.jsx)(`div`,{className:`home-top-destinations`,children:f.length==0?(0,d.jsx)(`p`,{children:`No top destination`}):f.map(e=>(0,d.jsxs)(`div`,{className:`card-ui`,onClick:()=>{v(e),y(`/vacayPlan/vacayDetails`)},children:[(0,d.jsxs)(`div`,{className:`card-img`,children:[(0,d.jsx)(`img`,{src:e.destinationImage}),(0,d.jsx)(`div`,{className:`card-rating`,children:(0,d.jsx)(u.Rating,{initialValue:e.destinationRating,readonly:!0,allowFraction:!0,size:`20px`})})]}),(0,d.jsx)(`p`,{className:`card-title`,children:e.destinationName}),(0,d.jsx)(`p`,{className:`card-subtitle`,children:n.find(t=>t.countryId==e.countryId).countryName}),(0,d.jsx)(`p`,{children:e.destinationDescription})]},e.destinationId))})]})}),(0,d.jsx)(o,{})]})}var p=f;export{p as default};