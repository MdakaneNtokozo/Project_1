import{l as e,m as t,n,s as r,t as i}from"./index-Dy5shDWX.js";import{t as a}from"./Loading-Dkvs0utl.js";import{t as o}from"./dist-B3-LkRQH.js";import"./iconBase-BgoDaE5U.js";import{t as s}from"./bi-CIcH-MPd.js";var c=t(e()),l=t(o()),u=t(n());function d(){let[e,t]=(0,c.useState)([]),[n,o]=(0,c.useState)([]),[d,f]=(0,c.useState)([]),{api:p,token:m,user:h,currency:g,startDate:_,endDate:v,selectedSpenderType:y,selectedDestination:b,selectedAttractions:x,setSelectedAttractions:S,attrsList:C,setAttrsList:w,attrsTotal:T,setAttrsTotal:E,selectedBuddies:D}=(0,c.useContext)(i),O=r(),[k,A]=(0,c.useState)(!0),[j,M]=(0,c.useState)(1);for((0,c.useEffect)(()=>{if(e.length==0){var n=p+`Destinations/getAttractions?destId=`+b.destinationId+`&currencyId= `+h.currencyId;fetch(n,{method:`GET`,headers:{Authorization:`Bearer `+m,"Content-Type":`application/json`}}).then(async e=>{e.status==401&&(console.log(`unauthorized`),O(`/`)),t(await e.json()),n=p+`LoginSignup/getSpenderTypes`,fetch(n,{method:`GET`,headers:{Authorization:`Bearer `+m,"Content-Type":`application/json`}}).then(async e=>{f(await e.json());var t=p+`Destinations/getSuggestedAttraction?spenderTypeId=`+y.spenderTypeId+`&destinationId= `+b.destinationId;fetch(t,{method:`GET`,headers:{Authorization:`Bearer `+m,"Content-Type":`application/json`}}).then(async e=>o(await e.json())),A(!1)})})}},[j]);k;)return(0,u.jsx)(a,{});let N=e=>{var e=new Date(e);if(e!=null){let t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return t+`-`+n+`-`+(r<10?`0`+r:r)}},P=()=>{var e=!0;if(x.length!=C.length)alert(`make sure that you filled in the details for the selected sttractions`);else if(C.forEach(t=>{var n=document.getElementById(`a`+t.attr.attractionId);t.num==null||t.num==``?(e=!1,n.textContent=`Please enter the number of times you'll experience `+t.attr.attractionName):n.textContent=``}),e){var t=p+`Destinations/getAttrsTotal?start=`+N(_)+`&end=`+N(v)+`&numOfPeople=`+(D.length+1);fetch(t,{method:`POST`,headers:{Authorization:`Bearer `+m,"Content-Type":`application/json`},body:JSON.stringify(C)}).then(async e=>{E(await e.json()),O(`/vacayPlan/preview`)})}},F=()=>{O(-1)},I=e=>{x.find(t=>t.attractionId==e.attractionId)==null?S([...x,e]):(S([...x.filter(t=>t.attractionId!=e.attractionId)]),w([...C.filter(t=>t.attr.attractionId!=e.attractionId)]))},L=e=>x.length==0?`card-ui`:x.find(t=>t.attractionId==e.attractionId)?`selected-card-ui`:`card-ui`,R=(e,t,n)=>{if(t!=0){var r={attr:e,useType:t,num:n};C.find(t=>t.attr.attractionId==e.attractionId)==null?w([...C,r]):w([...C.filter(t=>t.attr.attractionId!=e.attractionId),r])}},z=n=>{n==2?t(e.sort((e,t)=>e.attractionEntranceFee-t.attractionEntranceFee)):n==3?t(e.sort((e,t)=>t.attractionEntranceFee-e.attractionEntranceFee)):n==4&&t(e.sort((e,t)=>t.attractionRating-e.attractionRating)),M(n)};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(`div`,{children:[(0,u.jsxs)(`h2`,{children:[`Select attractions from `,b.destinationName]}),(0,u.jsxs)(`select`,{value:j,onChange:e=>z(e.target.value),children:[(0,u.jsx)(`option`,{value:1,children:`Filter by:`}),(0,u.jsx)(`option`,{value:2,children:`Lowest - highest`}),(0,u.jsx)(`option`,{value:3,children:`Highest - lowest`}),(0,u.jsx)(`option`,{value:4,children:`Rating`})]}),(0,u.jsx)(`div`,{className:`cards-section`,children:e.length.length==0?(0,u.jsx)(`p`,{children:`no accommodations`}):e.map((e,t)=>{var r=n.find(t=>t.attractionId==e.attractionId)!=null;return(0,u.jsxs)(`div`,{className:L(e),onClick:()=>I(e),children:[(0,u.jsxs)(`div`,{className:`card-img`,children:[(0,u.jsx)(`img`,{src:e.attractionImage}),(0,u.jsx)(`div`,{className:`card-rating`,children:(0,u.jsx)(l.Rating,{initialValue:e.attractionRating,readonly:!0,allowFraction:!0,size:`20px`})}),r?(0,u.jsx)(`div`,{className:`suggested`,children:(0,u.jsx)(s,{size:`35px`,color:`yellow`})}):(0,u.jsx)(u.Fragment,{})]}),(0,u.jsx)(`p`,{className:`card-title`,children:e.attractionName}),(0,u.jsx)(`p`,{className:`card-subtitle`,children:e.attractionAddress}),(0,u.jsxs)(`p`,{children:[g.currencySymbol,` `,e.attractionEntranceFee,` entrance fee`]}),(0,u.jsxs)(`p`,{children:[`Is it time limited: `,e.attractionTimeLimited==1?`yes`:`no`,` `]}),(0,u.jsx)(`p`,{children:e.attractionDescription})]},t)})})]}),(0,u.jsxs)(`div`,{className:`more-details`,children:[(0,u.jsx)(`h3`,{children:`Fill in details below`}),x.length==0?(0,u.jsx)(`p`,{children:`No attractions selected`}):(0,u.jsx)(u.Fragment,{children:x.map((e,t)=>{var n=C.find(t=>t.attr.attractionId==e.attractionId);return(0,u.jsxs)(`div`,{children:[(0,u.jsx)(`p`,{className:`card-title`,children:e.attractionName}),(0,u.jsx)(`label`,{children:`Type of use for attraction expereince:`}),(0,u.jsxs)(`select`,{value:n==null?0:n.useType,onChange:t=>R(e,t.target.value,void 0),children:[(0,u.jsx)(`option`,{value:0,children:`How many times will you expereince this attraction`}),(0,u.jsx)(`option`,{value:1,children:`Limited throughout the trip`}),(0,u.jsx)(`option`,{value:2,children:`Every day of the trip`})]}),(0,u.jsx)(`label`,{children:`Specify the number of times it will be experienced:`}),(0,u.jsx)(`input`,{type:`number`,min:0,value:n==null?``:n.num,onChange:t=>R(e,n.useType,t.target.value)}),(0,u.jsx)(`p`,{className:`error-msg`,id:`a`+e.attractionId,style:{margin:`0px`,marginBottom:`8px`}})]},t)})})]}),(0,u.jsxs)(`div`,{style:{display:`flex`,flexDirection:`row`,justifyContent:`space-between`},children:[(0,u.jsx)(`button`,{onClick:F,type:`button`,children:`Back`}),(0,u.jsx)(`button`,{onClick:P,type:`button`,children:`Next`})]})]})}var f=d;export{f as default};