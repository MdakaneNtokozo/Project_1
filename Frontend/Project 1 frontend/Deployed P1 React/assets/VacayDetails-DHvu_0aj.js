import{l as e,m as t,n,s as r,t as i}from"./index-Dy5shDWX.js";import{t as a}from"./Loading-Dkvs0utl.js";import{t as o}from"./iconBase-BgoDaE5U.js";import{t as s}from"./build-CnW8lL0w.js";import{t as c}from"./fa-y09jtI8n.js";var l=t(s()),u=t(e());function d(e){return o({tag:`svg`,attr:{viewBox:`0 0 384 512`},child:[{tag:`path`,attr:{d:`M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z`},child:[]}]})(e)}var f=t(n());function p(){let{api:e,token:t,user:n,selectedDestination:o,startDate:s,setStartDate:p,endDate:m,setEndDate:h,selectedSpenderType:g,setSelectedSpenderType:_,selectedBuddies:v,setSelectedBuddies:y}=(0,u.useContext)(i),[b,x]=(0,u.useState)([]),[S,C]=(0,u.useState)(v.length==0?`false`:`true`),[w,T]=(0,u.useState)([]),[E,D]=(0,u.useState)(``),[O,k]=(0,u.useState)(``),[A,j]=(0,u.useState)(``),M=r(),[N,P]=(0,u.useState)(!0),[F,I]=(0,u.useState)(!0),[L,R]=(0,u.useState)(!0);for((0,u.useEffect)(()=>{var r=e+`LoginSignup/getSpenderTypes`;fetch(r,{method:`GET`,headers:{Authorization:`Bearer `+t,"Content-Type":`application/json`}}).then(async i=>{i.ok?(x(await i.json()),r=e+`LoginSignup/users`,fetch(r,{method:`GET`,headers:{Authorization:`Bearer `+t,"Content-Type":`application/json`}}).then(async e=>{if(e.ok){var t=await e.json();t=t.filter(e=>e.userId!=n.userId),T(t)}}),P(!1)):i.status==401&&(console.log(`unauthorized`),M(`/home`))})},[]);N==1;)return(0,f.jsx)(a,{});let z=e=>{if(e==null)return``;var e=new Date(e);if(e!=``){let t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return t+`-`+n+`-`+(r<10?`0`+r:r)}},B=()=>{D(``),k(``),j(``);let e=new Date(z(new Date));e.setHours(0),s==null&&m==null?D(`Select start and end dates`):new Date(s)<e||new Date(m)<e?D(`Dates should be today onwards`):g==null?k(`Please select type of spender`):S==``?j(`Select whether you are traveling alone or with others`):S==`true`&&v.length==0?j(`Select buddies who will travel with you`):M(`/vacayPlan/transportation`)},V=()=>{M(-1)},H=e=>{var t=b.find(t=>t.spenderTypeName==e.target.value);_(t)},U=e=>{let t=w.find(t=>t.userName==e.target.value);!v.includes(t)&&t!=null&&(y([...v,t]),e.target.value=``)},W=e=>{let t=w.find(t=>t.userId==e);y([...v.filter(e=>e.userId!=t.userId)])},G=e=>{e.length==2&&(p(e[0]),h(e[1]))};return(0,f.jsx)(f.Fragment,{children:b.length==0?(0,f.jsx)(a,{}):(0,f.jsxs)(`div`,{className:`adding-details-container`,children:[(0,f.jsxs)(`div`,{children:[(0,f.jsxs)(`h2`,{children:[`Vacation plan for `,o.destinationName]}),(0,f.jsx)(`label`,{children:`Select date range`}),(0,f.jsx)(`br`,{}),(0,f.jsx)(l.default,{mode:`range`,range:!0,value:[z(s),z(m)],onChange:e=>G(e),className:`date-picker`}),(0,f.jsx)(`br`,{}),E==``?(0,f.jsx)(f.Fragment,{}):(0,f.jsx)(`p`,{className:`error-msg`,style:{margin:`0px`,marginBottom:`8px`},children:E}),(0,f.jsx)(`label`,{children:`What type of spender are you?`}),(0,f.jsxs)(`select`,{placeholder:`What type of spender are you?`,value:g==null?``:g.spenderTypeName,onChange:e=>H(e),required:!0,children:[(0,f.jsx)(`option`,{value:``,children:`Select the type of spender you are`}),b.map(e=>(0,f.jsx)(`option`,{value:e.spenderTypeName,children:e.spenderTypeName},e.spenderTypeId))]}),O==``?(0,f.jsx)(f.Fragment,{}):(0,f.jsx)(`p`,{className:`error-msg`,style:{margin:`0px`,marginBottom:`8px`},children:O}),(0,f.jsx)(`label`,{children:`Will you travel with others?`}),(0,f.jsxs)(`select`,{placeholder:`What type of spender are you?`,value:S,onChange:e=>{j(``),C(e.target.value)},required:!0,children:[(0,f.jsx)(`option`,{value:``,children:`Select an option`}),(0,f.jsx)(`option`,{value:!1,children:`No`}),(0,f.jsx)(`option`,{value:!0,children:`Yes`})]}),S==`true`?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(`label`,{children:`Add travel buddies`}),(0,f.jsxs)(`div`,{className:`search`,children:[(0,f.jsx)(c,{className:`search-icon`}),(0,f.jsx)(`input`,{placeholder:`Search for travel companions`,list:`companions`,onSelect:e=>{U(e),j(``)}})]}),(0,f.jsx)(`datalist`,{id:`companions`,children:w.map(e=>(0,f.jsxs)(`option`,{value:e.userName,children:[e.userName,` `,e.userSurname]},e.userId))}),(0,f.jsx)(`div`,{className:`buddies-container`,children:v.length==0?(0,f.jsx)(`p`,{children:`No travel buddies selected`}):(0,f.jsx)(f.Fragment,{children:v.map((e,t)=>(0,f.jsxs)(`div`,{className:`buddy-container`,children:[(0,f.jsxs)(`div`,{className:`buddy-details`,children:[(0,f.jsx)(`img`,{src:`\\src\\assets\\profile.jpg`}),(0,f.jsxs)(`div`,{children:[(0,f.jsxs)(`h4`,{children:[e.userName,` `,e.userSurname]}),(0,f.jsx)(`h4`,{children:e.userEmail})]})]}),(0,f.jsx)(d,{className:`buddy-remove`,onClick:()=>W(e.userId)})]},t))})})]}):(0,f.jsx)(f.Fragment,{}),A==``?(0,f.jsx)(f.Fragment,{}):(0,f.jsx)(`p`,{className:`error-msg`,style:{margin:`0px`,marginBottom:`8px`},children:A})]}),(0,f.jsxs)(`div`,{style:{display:`flex`,flexDirection:`row`,justifyContent:`space-between`},children:[(0,f.jsx)(`button`,{onClick:V,type:`button`,children:`Back`}),(0,f.jsx)(`button`,{onClick:B,type:`button`,children:`Next`})]})]})})}var m=p;export{m as default};